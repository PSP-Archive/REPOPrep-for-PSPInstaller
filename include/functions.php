<?php /* PSPInstaller - RepoPrep - http://pspinstaller.rsparrow.co.uk/ */ if(time()>1264631696){}   function kSJ6a( $value ) { if ( is_numeric( $value ) ) { return $value; } else { $mYt140 = strlen( $value ); $YOhf5 = substr( $value, 0, $mYt140 - 1 ); $RsZ135 = strtolower( substr( $value, $mYt140 - 1 ) ); switch ( $RsZ135 ) { case 'k': $YOhf5 *= 1024; break; case 'm': $YOhf5 *= 1048576; break; case 'g': $YOhf5 *= 1073741824; break; } return $YOhf5; } } function getMaxUpload() { return kSJ6a( ini_get( 'upload_max_filesize' ) ) / 1048576; } function DFSa2($s) { return substr($s, strrpos($s, ".")); } function hXn82($OoIb5, $UXn128 = 'li', $nFF44 = 'active', $Rtk6e = NULL) { if (is_array($OoIb5)) { $lPd67 = true; if ($Rtk6e === NULL) { $lPd67 = false; $Rtk6e = $_SERVER['REQUEST_URI']; } foreach($OoIb5 as $TACb7=>$XgK13d) { if (is_array($XgK13d)) { $url = $XgK13d[0]; $Rtk6e = defined('CURRENT_PAGE') ? CURRENT_PAGE : ''; $class = ($Rtk6e == $XgK13d[1]) ? sprintf(' class="%s" ', $nFF44) : ''; } else { $url = $XgK13d; $class = ($lPd67 ? ($url == $Rtk6e) : (strpos($Rtk6e, $url) !== false)) ? sprintf(' class="%s" ', $nFF44) : ''; } printf('<%s%s><a href="%s">%s</a></%s>', $UXn128, $class, $url, $TACb7, $UXn128); } } } function drawfilters($OoIb5, $oFVe6, $nrF6d = '', $UXn128 = 'li', $nFF44 = 'active', $dbl97 = 'filter') { global $aZr114; if (is_array($OoIb5)) { $i=0; $KiF130 = count($OoIb5); foreach($OoIb5 as $TACb7=>$XgK13d) { $class = $XgK13d == $nrF6d ? sprintf(' class="%s" ', $nFF44) : ''; printf('<%s%s><a href="%s.php%s">%s</a>%s</%s>', $UXn128, $class, $oFVe6, ($XgK13d != '' ? '?' . $dbl97 . '='. $XgK13d . ($aZr114 !== '' ? '&amp;search=' . htmlspecialchars($aZr114) : '') : ($aZr114 !== '' ? '?search=' . htmlspecialchars($aZr114) : '')), $TACb7, (++$i != $KiF130 ? ' | ' : ''), $UXn128); } } } $qgJ30 = array(); function addMessage($class, $cYYc9) { global $qgJ30; if (!isset($qgJ30)) $qgJ30 = array(); $qgJ30[] = array('class'=>$class, 'message'=>$cYYc9); } function lmc80() { global $qgJ30; if (isset($qgJ30) && is_array($qgJ30)) { foreach($qgJ30 as $cYYc9) { printf( '<div class="statusmsg %s" style="display:none;"><div class="close" title="Close this message.">&times;</div>%s</div>', htmlspecialchars($cYYc9['class']), $cYYc9['message'] ); } } } $GaE31 = array(); function qor47($JFd119) { global $GaE31; if (!isset($GaE31)) $GaE31 = array(); $GaE31[] = sprintf('<script type="text/javascript" src="%s"></script>', $JFd119); } function VPL48($code) { global $GaE31; if (!isset($GaE31)) $GaE31 = array(); $qqNbb = sizeof($GaE31) != 0 && $GaE31[ sizeof($GaE31)-1 ] == '</script>'; if ($qqNbb) {
array_pop($GaE31); array_pop($GaE31); } else { $GaE31[] = '<script type="text/javascript">'; $GaE31[] = '// <![CDATA['; } $GaE31[] = $code; $GaE31[] = '// ]]>'; $GaE31[] = '</script>'; } function tXT81() { global $GaE31; if (isset($GaE31) && is_array($GaE31)) print join("\r\n", $GaE31); } function GGoae($OpJ9b, $GlF9a = '') { $GGoae = ''; switch($OpJ9b) { case Lbe2a: $OoIb5 = array('Approve'=>'approve,approved','Deny'=>'deny,denied'); break; case UrH28: $OoIb5 = array('Unapprove'=>'unapprove,pending','Deny'=>'deny,denied'); break; case GzZ29: $OoIb5 = array('Approve'=>'approve,approved','Make pending'=>'unapprove,pending'); if ($GlF9a == 'denied') { $OoIb5['Delete permenently'] = 'delete,denied'; } break; default: $OoIb5 = array(); break; } $c = count($OoIb5); $i = 0; foreach($OoIb5 as $TACb7=>$XgK13d) { $w = explode(',', $XgK13d); $GGoae.= sprintf('<span class="%s" onclick="headsupClick(\'%s\',this);">%s</span>%s', $w[1], $w[0], $TACb7, (++$i != $c ? ' | ' : '')); } return $GGoae; } function raD136($KjNde, $new, $db) { if ($new['Verified'] != $KjNde['Verified'] || $new['Category'] != $KjNde['Category']) { $Kmee0 = MPRc7($KjNde); $FdGd8 = MPRc7($new); $MVBd6 = dirname($FdGd8); if (file_exists($Kmee0) && is_file($Kmee0)) { if (!file_exists($MVBd6)) { @mkdir($MVBd6); if (!file_exists($MVBd6)) { addMessage('error', sprintf('Unable to ceate the directory %s.', $MVBd6)); return false; } } $FdGd8 = DpY6b($FdGd8); @rename($Kmee0, $FdGd8); if (!file_exists($FdGd8)) { addMessage('error', sprintf('Unable to move file "%s" to "%s".', $Kmee0, $FdGd8)); return false; } } if ($db->Update(sprintf('UPDATE %s SET Verified = %s, Category = \'%s\' WHERE ID = %d LIMIT 1;', ojb22, $new['Verified'], $new['Category'], $KjNde['ID'])) === NULL) { return false; } } $ane8a = array('Name'=>false,'Description'=>true,'Author_Name'=>true,'Author_Email'=>true); $FcM138 = array(); foreach($ane8a as $DmT88=>$ePhd2) { if ($new[$DmT88] != $KjNde[$DmT88]) { $XgK13d = trim($new[$DmT88]); $cRFf6 = ($ePhd2 && empty($XgK13d) ? '' : '\''); $FcM138[]= sprintf('%s = %s%s%s', $DmT88, $cRFf6, ($ePhd2 && empty($XgK13d) ? 'NULL' : $db->Escape($XgK13d)), $cRFf6); } } if (count($FcM138) != 0) { if ($db->Update(sprintf('UPDATE %s SET %s WHERE ID = %d LIMIT 1;', ojb22, implode(', ', $FcM138), $KjNde['ID'])) === NULL) { return false; } } return true; } function ObZ7b($TmZb1, $db) { $filename = MPRc7($TmZb1); if (file_exists($filename) && is_file($filename)) { @unlink($filename); if (file_exists($filename)) { addMessage('error', sprintf('Unable to delete file "%s", associated with "%s".', $filename, htmlspecialchars($TmZb1['Name']))); return false; } } if ($db->UNl18(sprintf('DELETE FROM %s WHERE ID = %s LIMIT 1', ojb22, $TmZb1['ID'])) === NULL) { return false;
} return true; } function MPRc7($TmZb1, $OXd11b = NULL) { if ($OXd11b === NULL) { $OXd11b = $TmZb1['Verified']; } return ohec6($OXd11b, $TmZb1['Category'], $TmZb1['Location']); } function ohec6($OXd11b, $Zbc5c, $filename) { return sprintf('%sfiles/%s/%s/%s', ROOT, Voc11d($OXd11b), $Zbc5c, str_replace(array('../', './', '..\\', '.\\'), '', $filename)); } function krZ12a($filename) { return sprintf('%sfiles/temp/%s', ROOT, str_replace(array('../', './', '..\\', '.\\'), '', $filename)); } function DpY6b($filename) { $i = 1; $Zgae3 = $filename; while (file_exists($filename) && is_file($filename)) { $kYEaf = strrpos($Zgae3, '.'); if ($kYEaf !== false) { $filename = sprintf('%s(%s)%s', substr($Zgae3, 0, $kYEaf), $i++, substr($Zgae3, $kYEaf)); } else { $filename = sprintf('%s(%s)', $Zgae3, $i++); } } return $filename; } function Voc11d($OXd11b) { switch($OXd11b) { case Lbe2a: return 'pending'; case UrH28: return 'approved'; case GzZ29: return 'denied'; default: return 'temp'; } } function jjD9f($OpJ9b) { switch($OpJ9b) { case Lbe2a: return 'Pending approval'; case UrH28: return 'Approved'; case GzZ29: return 'Denied'; default: return 'Unknown'; } } function ZRe9d($OpJ9b) { switch($OpJ9b) { case Ezed: return 'Game'; case ziPc: return 'Application'; case THef: return 'Theme'; case rZJe: return 'Other'; default: return 'Unknown'; } } function friendlySystemStatus($OpJ9b) { switch($OpJ9b) { case SYS_PENDING: return 'Pending approval'; case AbA2b: return 'Registered and approved'; case NMd2c: return 'Registration has been denied'; case SYS_NOTREGISTERED: return 'System is not registered'; default: return 'Unknown status'; } } function classSystemStatus($OpJ9b) { switch($OpJ9b) { case SYS_PENDING: return 'sys-pending'; case AbA2b: return 'sys-approved'; case NMd2c: return 'sys-denied'; case SYS_NOTREGISTERED: return 'sys-notregistred'; default:
return 'sys-unknown'; } } function FeD89($error) { die(sprintf('<br /><strong>Fatal error!</strong> Could not complete your request.<br /><blockquote>%s</blockquote>', $error)); } function eTh98($MbI13e, $empty = '') { return $MbI13e === NULL || $MbI13e === 0 || $MbI13e === false ? $empty : $MbI13e; } function fzr54($nkF40) { if (!is_array($nkF40)) { throw new Exception("\x49\156\x70\x75\164 is not \141n \101\162r\141\x79"); } $HCk3f = array(); $ARD3e = array_keys($nkF40); $eEo41 = array_values($nkF40); for ($fZL146=0;$fZL146<count($ARD3e);$fZL146++) { if (is_object($eEo41[$fZL146])) { $HCk3f[$ARD3e[$fZL146]]=clone $eEo41[$fZL146]; } elseif (is_array($eEo41[$fZL146])) { $HCk3f[$ARD3e[$fZL146]]=fzr54 ($eEo41[$fZL146]); } else { $HCk3f[$ARD3e[$fZL146]]=$eEo41[$fZL146]; } } return $HCk3f; } function lSl70($iYA11f, $aiLbf, $RlM127 = '&hellip;') { if (strlen($iYA11f) > $aiLbf) { return substr($iYA11f, 0, $aiLbf) . $RlM127; } return $iYA11f; } function PTg7f($error, $FNY92) { if (defined('NGi1a')) { header(sprintf('Location: file.php?id=%d&downloaderror=%s', $FNY92, urlencode($error))); exit; } else { header(sprintf('%s 404 Not Found', $_SERVER["\123\105\122\x56E\122_\120\x52\117\x54\117\x43O\x4c"])); FeD89('The file you\'ve requested does not exist.'); } } function locDate($mnM12d) { if (!is_numeric($mnM12d)) { $mnM12d = strtotime($mnM12d); } if (date('Y-m-d', $mnM12d) == date('Y-m-d')) return 'Today'; if (date('Y-m-d', $mnM12d) == date('Y-m-d',time()-86400)) return 'Yesterday'; if (date('Y-m-d', $mnM12d) == date('Y-m-d',time()+86400)) return 'Tomorrow'; return date(config('Local_DateFormat'), $mnM12d); } function locTime($mnM12d) { if (!is_numeric($mnM12d)) { $mnM12d = strtotime($mnM12d); } return date(config('Local_TimeFormat'), $mnM12d); } function zmsc5($pVOdd) { return config('Local_NumberFormat') == 'R' ? number_format($pVOdd, 0, ',', '.') : number_format($pVOdd, 0, '.', ','); } function encrypt($iYA11f) { $iYA11f = sprintf('%s%s%s', '*(MMEDV6RTNE7B6\A4WN5<*896BI6BNR3X', $iYA11f, 'B%v76*V%&(Bbv$Ev547v98*&B%'); return sha1($iYA11f); } function bsN8b($var, $mCzb2, &$tVSc3) { $i = 1; foreach($mCzb2 as $TmZb1) { $tVSc3[] = zRa8c($var, $i++, $TmZb1); } } function zRa8c($var, $pVOdd, $TmZb1) { return sprintf('%s[%d]={i=%d,n="%s",d="%s",f="%s"}', $var, $pVOdd, $TmZb1['ID'], PAj86($TmZb1['Name']), PAj86(lSl70(eTh98($TmZb1['Description']), 300, '...')), PAj86($TmZb1['Location']) ); } function PAj86($iYA11f) { return str_replace(array('"',"\r\n","\n","\r"), array('\\"','\r\n','\r\n','\r\n'), $iYA11f); } function HHJ13f($name) {
return isset($_GET[$name]) && !empty($_GET[$name]) && is_numeric($_GET[$name]) && floor($_GET[$name]) > time() - 120; } function sHVf3($db) { if (isset($_POST['selected_files']) && is_array($_POST['selected_files']) && count($_POST['selected_files']) != 0) { $action = NULL; if (isset($_POST['action'], $_POST['apply']) && !empty($_POST['apply']) && !empty($_POST['action'])) { $action = trim(strtolower($_POST['action'])); } if (isset($_POST['action2'], $_POST['apply2']) && !empty($_POST['apply2']) && !empty($_POST['action2'])) { $action = trim(strtolower($_POST['action2'])); } $HsP137 = 0; $list = ''; switch($action) { case 'approve': $snD42 = UrH28; $beS43 = 'Approved'; break; case 'deny': $snD42 = GzZ29; $beS43 = 'Denied'; break; case 'unapprove': $snD42 = Lbe2a; $beS43 = 'Unapproved'; break; case 'delete': $snD42 = GzZ29; $beS43 = 'Deleted'; break; } if (isset($snD42)) { foreach($_POST['selected_files'] as $XgK13d) { if (is_numeric($XgK13d)) { $TmZb1 = $db->Select(sprintf('SELECT * FROM %s WHERE ID = %s LIMIT 1;', ojb22, $db->Escape($XgK13d))); if (is_array($TmZb1) && count($TmZb1) == 1) { $TmZb1 = $TmZb1[0]; if ($TmZb1['Verified'] != $snD42) { $RfMd7 = fzr54($TmZb1); $RfMd7['Verified'] = $snD42; if (!raD136($TmZb1, $RfMd7, $db)) { addMessage('error', sprintf('Error updating %s (ID: %s)!', htmlspecialchars($TmZb1['Name']), $TmZb1['ID'])); break; } else { $list.= sprintf('<li>%s</li>', htmlspecialchars($TmZb1['Name'])); $HsP137++; } } if ($action == 'delete') { if (!ObZ7b($TmZb1, $db)) { addMessage('error', sprintf('Error deleting %s (ID: %s)!', htmlspecialchars($TmZb1['Name']), $TmZb1['ID'])); break; } else { $list.= sprintf('<li>%s</li>', htmlspecialchars($TmZb1['Name'])); $HsP137++; } } } } } if ($HsP137 != 0) { addMessage('success', sprintf('%s %s %s: <ul>%s</ul>', $beS43, $HsP137, ($HsP137 == 1 ? 'file' : 'files'), $list)); TriggerUpdate(); } } } } function VVB2e($mnM12d) { return date('Y-m-d', $mnM12d); } function kZb105($FNY92, $db) { $ZPkd1 = VVB2e(time()); $db->Update(sprintf('UPDATE `%s` SET `Downloads` = `Downloads` + 1 WHERE `ID` = %d LIMIT 1;', ojb22, $FNY92)); if (!$db->Update(sprintf('UPDATE `%s` SET `Downloads` = `Downloads` + 1 WHERE `FileID` = %d AND `Date` = \'%s\' LIMIT 1;', cDZ21, $FNY92, $ZPkd1))) { $db->Ror1d(sprintf('INSERT INTO `%s` (`Date`, `FileID`, `Downloads`) VALUES (\'%s\', %d, 1);', cDZ21, $ZPkd1, $FNY92)); } } function RSkba($Pbq78, $time, $LoAe1=false) { if ($LoAe1 && $Pbq78 == date('l', $time)) return strtotime('Midnight Today', $time); return strtotime('Last ' . $Pbq78); } function NNDd9($Pbq78, $time, $LoAe1=false) { if ($LoAe1 && $Pbq78 == date('l', $time)) return strtotime('Midnight Today', $time); return strtotime('Next ' . $Pbq78); } function OOC46($pVOdd=0){ while($pVOdd > 0 && strlen($pVOdd) > 0 && substr($pVOdd, 0, 1) == '0') $pVOdd = substr($pVOdd, 1); return $pVOdd.(((strlen($pVOdd)>1)&&(substr($pVOdd,-2,1)=='1'))? 'th' : date("\x53",mktime(0,0,0,0,substr($pVOdd,-1),0))); } 
function IFm9e($label, $TXF10f) { $hRZb9 = explode('-', $label); switch($TXF10f) { case 'day': return date('M d', mktime(0,0,0, $hRZb9[1], $hRZb9[2], $hRZb9[0]) ); case 'week': $w = array_pop($hRZb9); if ($w == 0) $w = 53; return OOC46($w); case 'month': return date('F', mktime(0,0,0, $hRZb9[1], 1, $hRZb9[0]) ); case 'quarter': return 'Q' . array_pop($hRZb9); default: return $label; } } function radioOption($name, $AcG141, $default = NULL) { $tVSc3 = array(); foreach($AcG141 as $TACb7=>$XgK13d) { $tVSc3[] = sprintf('<input type="radio" name="%1$s" value="%2$s" id="r%1$s_%2$s" %3$s /> <label for="r%1$s_%2$s">%4$s</label>', $name, $TACb7, ($default == $TACb7 ? ' checked="checked" ' : ''), $XgK13d); } return implode('<br />', $tVSc3); } function fhp($iYA11f) { print htmlspecialchars($iYA11f); } function p($iYA11f) { print $iYA11f; } function is_ssl() { return ($_SERVER['SERVER_PORT'] == 443 || (isset($_SERVER['HTTPS']) && ($_SERVER['HTTPS'] == true || $_SERVER['HTTPS'] == 'on') ) ); } function ct($ejDad, $ATEd4) { return strpos($ejDad, $ATEd4) !== false; } function bit139($error) { addMessage('error', sprintf('Unable to complete upload:<ul><li>%s</li></ul>', $error)); } function TriggerUpdate() { config('LastUpdate', time()); } ; ?>
